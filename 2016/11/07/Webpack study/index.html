<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Duyb"><title>Webpack study · Duyb</title><meta name="description" content="1. Webpack
安装： npm install webpack -g通常我们会将 Webpack 安装到项目的依赖中，这样就可以使用项目本地版本的 Webpack。npm install webpack --save-dev
首先创建一个静态页面 index.html 和一个 JS 入口文件 "><meta name="keywords" content="js,JavaScript,HTML,CSS,Duyb,2010thxl"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">Duyb</a></h3><div class="description"><p>摇一叶小舟，在代码的大海里遨游……</p></div></div></div><ul class="social-links"><li><a href="http://github.com/thxl2010"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img src="/images/logo.png"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Webpack study</a></h3></div><div class="post-content"><h1 id="1-Webpack"><a href="#1-Webpack" class="headerlink" title="1. Webpack"></a>1. Webpack</h1><ol>
<li>安装： <code>npm install webpack -g</code><br>通常我们会将 Webpack 安装到项目的依赖中，这样就可以使用项目本地版本的 Webpack。<br><code>npm install webpack --save-dev</code></li>
<li>首先创建一个静态页面 index.html 和一个 JS 入口文件 entry.js;然后编译 entry.js 并打包到 bundle.js：<br><code>webpack entry.js bundle.js</code></li>
</ol>
<h1 id="2-Loader"><a href="#2-Loader" class="headerlink" title="2. Loader"></a>2. <strong>Loader</strong></h1><p>  Webpack 本身只能处理 JavaScript 模块，如果要处理其他类型的文件，就需要使用 loader 进行转换。Loader 可以理解为是模块和资源的转换器，<br>  它本身是一个函数，接受源文件作为参数，返回转换的结果。这样，我们就可以通过 <code>require</code> 来加载任何类型的模块或文件，比如 CoffeeScript、 JSX、 LESS 或图片。</p>
<ol>
<li><p>Loader 可以在 require() 引用模块的时候添加，也可以在 webpack 全局配置中进行绑定，还可以通过命令行的方式使用。<br>我们在页面中引入一个 CSS 文件 style.css，首页将 style.css 也看成是一个模块，然后用 <code>css-loader</code> 来读取它，再用 <code>style-loader</code> 把它插入到页面中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/* style.css */</div><div class="line">body &#123; background: yellow; &#125;</div></pre></td></tr></table></figure>
<p>修改 entry.js：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">require(&quot;!style!css!./style.css&quot;) // 载入 style.css</div><div class="line">document.write(&apos;It works.&apos;)</div><div class="line">document.write(require(&apos;./module.js&apos;))</div></pre></td></tr></table></figure>
<p>安装 loader：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install css-loader style-loader</div></pre></td></tr></table></figure>
<p>重新编译打包</p>
</li>
<li><p>如果每次 <code>require</code> CSS 文件的时候都要写 loader 前缀，是一件很繁琐的事情。我们可以根据模块类型（扩展名）来自动绑定需要的 loader。<br>将 entry.js 中的 <code>require(&quot;!style!css!./style.css&quot;)</code> 修改为 <code>require(&quot;./style.css&quot;)</code> ，然后执行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">webpack entry.js bundle.js --module-bind &apos;css=style!css&apos;</div><div class="line">// 有些环境下可能需要使用双引号</div><div class="line">webpack entry.js bundle.js --module-bind &quot;css=style!css&quot;</div></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="3-配置文件"><a href="#3-配置文件" class="headerlink" title="3. 配置文件"></a>3. 配置文件</h1><p>Webpack 在执行的时候，除了在命令行传入参数，还可以通过指定的配置文件来执行。默认情况下，会搜索当前目录的 webpack.config.js 文件，<br>这个文件是一个 node.js 模块，返回一个 json 格式的配置信息对象，或者通过 –config 选项来指定配置文件。<br>创建一个配置文件 <code>webpack.config.js</code>：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">var webpack = require(&apos;webpack&apos;)module.exports = &#123;</div><div class="line">  entry: &apos;./entry.js&apos;,</div><div class="line">  output: &#123;</div><div class="line">    path: __dirname,</div><div class="line">    filename: &apos;bundle.js&apos;</div><div class="line">  &#125;,</div><div class="line">  module: &#123;</div><div class="line">    loaders: [</div><div class="line">      &#123;test: /\.css$/, loader: &apos;style!css&apos;&#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">var webpack = require(&apos;webpack&apos;);</div><div class="line">var commonsPlugin = new webpack.optimize.CommonsChunkPlugin(&apos;common.js&apos;);</div><div class="line"> </div><div class="line">module.exports = &#123;</div><div class="line">    //插件项</div><div class="line">    plugins: [commonsPlugin],</div><div class="line">    //页面入口文件配置</div><div class="line">    entry: &#123;</div><div class="line">        index : &apos;./src/js/page/index.js&apos;</div><div class="line">    &#125;,</div><div class="line">    //入口文件输出配置</div><div class="line">    output: &#123;</div><div class="line">        path: &apos;dist/js/page&apos;,</div><div class="line">        filename: &apos;[name].js&apos;</div><div class="line">    &#125;,</div><div class="line">    module: &#123;</div><div class="line">        //加载器配置</div><div class="line">        loaders: [</div><div class="line">            &#123; test: /\.css$/, loader: &apos;style-loader!css-loader&apos; &#125;,</div><div class="line">            &#123; test: /\.js$/, loader: &apos;jsx-loader?harmony&apos; &#125;,</div><div class="line">            &#123; test: /\.scss$/, loader: &apos;style!css!sass?sourceMap&apos;&#125;,</div><div class="line">            &#123; test: /\.(png|jpg)$/, loader: &apos;url-loader?limit=8192&apos;&#125;</div><div class="line">        ]</div><div class="line">    &#125;,</div><div class="line">    //其它解决方案配置</div><div class="line">    resolve: &#123;</div><div class="line">        root: &apos;E:/github/flux-example/src&apos;, //绝对路径</div><div class="line">        extensions: [&apos;&apos;, &apos;.js&apos;, &apos;.json&apos;, &apos;.scss&apos;],</div><div class="line">        alias: &#123;</div><div class="line">            AppStore : &apos;js/stores/AppStores.js&apos;,</div><div class="line">            ActionType : &apos;js/actions/ActionType.js&apos;,</div><div class="line">            AppAction : &apos;js/actions/AppAction.js&apos;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>然后运行 <code>webpack</code>，生成 <code>bundle.js</code></p>
<p><strong>resolve： </strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">resolve: &#123;</div><div class="line">        //查找module的话从这里开始查找</div><div class="line">        root: &apos;E:/github/flux-example/src&apos;, //绝对路径</div><div class="line">        //自动扩展文件后缀名，意味着我们require模块可以省略不写后缀名</div><div class="line">        extensions: [&apos;&apos;, &apos;.js&apos;, &apos;.json&apos;, &apos;.scss&apos;],</div><div class="line">        //模块别名定义，方便后续直接引用别名，无须多写长长的地址</div><div class="line">        alias: &#123;</div><div class="line">            AppStore : &apos;js/stores/AppStores.js&apos;,//后续直接 require(&apos;AppStore&apos;) 即可</div><div class="line">            ActionType : &apos;js/actions/ActionType.js&apos;,</div><div class="line">            AppAction : &apos;js/actions/AppAction.js&apos;</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure></p>
<hr>
<p><strong>module.loaders 是最关键的一块配置。它告知 webpack 每一种文件都需要使用什么加载器来处理：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">module: &#123;</div><div class="line">        //加载器配置</div><div class="line">        loaders: [</div><div class="line">            //.css 文件使用 style-loader 和 css-loader 来处理</div><div class="line">            &#123; test: /\.css$/, loader: &apos;style-loader!css-loader&apos; &#125;,</div><div class="line">            //.js 文件使用 jsx-loader 来编译处理</div><div class="line">            &#123; test: /\.js$/, loader: &apos;jsx-loader?harmony&apos; &#125;,</div><div class="line">            //.scss 文件使用 style-loader、css-loader 和 sass-loader 来编译处理</div><div class="line">            &#123; test: /\.scss$/, loader: &apos;style!css!sass?sourceMap&apos;&#125;,</div><div class="line">            //图片文件使用 url-loader 来处理，小于8kb的直接转为base64</div><div class="line">            &#123; test: /\.(png|jpg)$/, loader: &apos;url-loader?limit=8192&apos;&#125;</div><div class="line">        ]</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>“-loader”其实是可以省略不写的，多个loader之间用“!”连接起来。</p>
<hr>
<p><strong>插件：</strong><br>插件可以完成更多 loader 不能完成的功能。</p>
<p>插件的使用一般是在 webpack 的配置信息 <code>plugins</code> 选项中指定。</p>
<p>Webpack 本身内置了一些常用的插件，还可以通过 npm 安装第三方插件。</p>
<p>接下来，我们利用一个最简单的 <code>BannerPlugin</code> 内置插件来实践插件的配置和运行，这个插件的作用是给输出的文件头部添加注释信息。</p>
<p>修改 <code>webpack.config.js</code>，添加 <code>plugins</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">var webpack = require(&apos;webpack&apos;)module.exports = &#123;</div><div class="line">  entry: &apos;./entry.js&apos;,</div><div class="line">  output: &#123;</div><div class="line">    path: __dirname,</div><div class="line">    filename: &apos;bundle.js&apos;</div><div class="line">  &#125;,</div><div class="line">  module: &#123;</div><div class="line">    loaders: [</div><div class="line">      &#123;test: /\.css$/, loader: &apos;style!css&apos;&#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  plugins: [</div><div class="line">    new webpack.BannerPlugin(&apos;This file is created by Duyb&apos;)</div><div class="line">  ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>Webpack遍历所有的依赖，我们希望避免执行第三方代码比如像jQuery,所以我们可以过滤它。Loaders有 include 和 exclude 两个规则。<br>它可以配置成一个字符串、正则表达式、一个或调或者其他你希望的，我们希望Babel只执行我们自己的文件，所以我们仅 include<br>我们自己的资源文件夹：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">module.exports = &#123;  </div><div class="line">entry: &apos;./src&apos;,</div><div class="line">    output: &#123;</div><div class="line">        path: &apos;builds&apos;,</div><div class="line">        filename: &apos;bundle.js&apos;,</div><div class="line">    &#125;,</div><div class="line">module: &#123;</div><div class="line">        loaders: [&#123;</div><div class="line">            test: /\.js/,</div><div class="line">            loader: &apos;babel&apos;,</div><div class="line">            include: /src/,</div><div class="line">        &#125;],</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<hr>
<p><strong>运行：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">webpack</div></pre></td></tr></table></figure></p>
<p>参数<code>--display-error-details</code>是推荐加上的，方便出错时能查阅更详尽的信息（比如 webpack 寻找模块的过程），从而更好定位到问题:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">webpack --display-error-details</div></pre></td></tr></table></figure></p>
<p>其他主要的参数有：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ webpack --config XXX.js   //使用另一份配置文件（比如webpack.config2.js）来打包</div><div class="line"> </div><div class="line">$ webpack --watch   //监听变动并自动打包</div><div class="line"> </div><div class="line">$ webpack -p    //压缩混淆脚本，这个非常非常重要！</div><div class="line"> </div><div class="line">$ webpack -d    //生成map映射文件，告知哪些模块被最终打包到哪里了</div></pre></td></tr></table></figure></p>
<h1 id="4-开发环境"><a href="#4-开发环境" class="headerlink" title="4. 开发环境"></a>4. 开发环境</h1><ol>
<li><p>当项目逐渐变大，webpack 的编译时间会变长，可以通过参数让编译的输出内容带有进度和颜色。<br><code>webpack --progress --colors</code><br>如果不想每次修改模块后都重新编译，那么可以启动监听模式。开启监听模式后，没有变化的模块会在编译后缓存到内存中，而不会每次都被重新编译，所以监听模式的整体速度是很快的。<br><code>webpack --progress --colors --watch</code><br>当然，使用 <code>webpack-dev-server</code> 开发服务是一个更好的选择。它将在 localhost:8080 启动一个 express 静态资源 web 服务器，<br>并且会以监听模式自动运行 webpack，在浏览器打开 <a href="http://localhost:8080/" target="_blank" rel="external">http://localhost:8080/</a> 或 <a href="http://localhost:8080/webpack-dev-server/" target="_blank" rel="external">http://localhost:8080/webpack-dev-server/</a><br>可以浏览项目中的页面和编译后的资源输出，并且通过一个 socket.io 服务实时监听它们的变化并自动刷新页面。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// 安装</div><div class="line">$ npm install webpack-dev-server -g</div><div class="line"></div><div class="line">// 运行</div><div class="line">$ webpack-dev-server --progress --colors</div></pre></td></tr></table></figure>
</li>
<li><p>热更新“Live Reload”以及热替换“Hot Module Replacement”（即HMR）</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">//方式 1:</div><div class="line">// 全局安装</div><div class="line">npm install webpack-dev-server --save</div><div class="line">// 终端输入</div><div class="line">$ webpack-dev-server --inline --hot</div><div class="line"></div><div class="line">//用法 2:</div><div class="line">// 添加到package.json scripts&quot;scripts&quot;: &#123;</div><div class="line"> &quot;start&quot;: &quot;webpack-dev-server --inline --hot&quot;,</div><div class="line"> ...</div><div class="line"> &#125;</div><div class="line">// 运行： </div><div class="line">$ npm start</div><div class="line"></div><div class="line">// 浏览器预览：</div><div class="line">http://localhost:8080</div></pre></td></tr></table></figure>
<hr>
<ol>
<li><strong>环境NODE_ENV</strong>:使用<strong>cross-env</strong>解决跨平台设置NODE_ENV的问题<ul>
<li>安装cross-env:<code>npm install cross-env --save-dev</code></li>
<li>在<code>NODE_ENV=xxxxxxx</code>前面添加<code>cross-env</code>就可以了。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&quot;scripts&quot;: &#123;</div><div class="line">  &quot;test&quot;: &quot;webpack --colors&quot;,</div><div class="line">  &quot;watch&quot;: &quot;cross-env NODE_ENV=development webpack --progress --colors --watch&quot;,</div><div class="line">  &quot;build&quot;: &quot;cross-env NODE_ENV=production webpack --colors&quot;,</div><div class="line">  &quot;server&quot;: &quot;webpack-dev-server --open --inline&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ol>
<h1 id="5-其他配置"><a href="#5-其他配置" class="headerlink" title="5. 其他配置"></a>5. 其他配置</h1><ul>
<li><p><strong>生成单独的css文件</strong>：<code>npm install extract-text-webpack-plugin --save-dev</code><br>先安装一下：npm install style-loader css-loader –save-dev，然后再重启下webpack-dev-server，就可以加载样式了，我们发现webpack是把样式动态插到了head标签的style里面，但是一般并不希望直接写到head里面，而是独立的一个css文件，这个时候借助一个分离css的插件就可以了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">var ExtractTextPlugin = require(&quot;extract-text-webpack-plugin&quot;);</div><div class="line">module.exports = &#123;</div><div class="line">    module: &#123;</div><div class="line">        loaders: [</div><div class="line">            // Extract css files</div><div class="line">            &#123;</div><div class="line">                test: /\.css$/,</div><div class="line">                loader: ExtractTextPlugin.extract(&quot;style-loader&quot;, &quot;css-loader&quot;)</div><div class="line">            &#125;,</div><div class="line">        ]</div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    plugins: [</div><div class="line">        new ExtractTextPlugin(&quot;[name].css&quot;)</div><div class="line">    ]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p><strong>内置插件OccurenceOrderPlugin</strong> :为组件分配ID，通过这个插件webpack可以分析和优先考虑使用最多的模块，并为它们分配最小的ID</p>
</li>
<li><strong>Common chunk：commonChunkPlugin</strong></li>
<li><strong>压缩和版本号：内置插件UglifyJsPlugin</strong></li>
<li><strong>自动生成 HTML 文件 html-webpack-plugin</strong>：<code>npm install html-webpack-plugin --save-dev</code><br>这个插件用来简化创建服务于 webpack bundle 的 HTML 文件，尤其是对于在文件名中包含了 hash 值，而这个值在每次编译的时候都发生变化的情况。<br>你既可以让这个插件来帮助你自动生成 HTML 文件，也可以使用 lodash 模板加载生成的 bundles，或者自己加载这些 bundles。</li>
<li>在一个生成环境构建之前我们也许希望我们的<strong>builds文件夹是清空</strong>的 clean-webpack-plugin：<code>npm install clean-webpack-plugin --save-dev</code></li>
<li><strong>open-browser-webpack-plugin</strong></li>
<li><p><strong>Environment flags</strong>：Environment flags (<a href="https://github.com/ruanyf/webpack-demos/tree/master/demo09" target="_blank" rel="external">source</a>)<br>You can enable some codes only in development environment with environment flags.</p>
<p>main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">document</span>.write(<span class="string">'&lt;h1&gt;Hello World&lt;/h1&gt;'</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (__DEV__) &#123;</div><div class="line">  <span class="built_in">document</span>.write(<span class="keyword">new</span> <span class="built_in">Date</span>());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"bundle.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>webpack.config.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> devFlagPlugin = <span class="keyword">new</span> webpack.DefinePlugin(&#123;</div><div class="line">  <span class="attr">__DEV__</span>: <span class="built_in">JSON</span>.stringify(<span class="built_in">JSON</span>.parse(process.env.DEBUG || <span class="string">'false'</span>))</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./main.js'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: [devFlagPlugin]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Now pass environment variable into webpack.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Linux &amp; Mac</span></div><div class="line">$ env DEBUG=<span class="literal">true</span> webpack-dev-server</div><div class="line"></div><div class="line"><span class="comment"># Windows</span></div><div class="line">$ <span class="built_in">set</span> DEBUG=<span class="literal">true</span></div><div class="line">$ webpack-dev-server</div></pre></td></tr></table></figure>
<ul>
<li><strong>webpack如何配置 插入jquery+jquery插件?</strong></li>
</ul>
<p>如果想引用第三方插件，不通过npm的方式，怎样加载？比如我想用一个jquery的插件，但是npm找不到，我下载到本地之后怎么加载，怎么配置？?<br>目的就是想用webpack + jquery + jquery插件 管理项目，请问webpack怎么配置？<br><a href="https://github.com/ruanyf/webpack-demos/tree/master/demo12" target="_blank" rel="external">https://github.com/ruanyf/webpack-demos/tree/master/demo12</a><br>原来，对于不支持CommonJS规范的模块，需要安装：<strong>imports-loader</strong><br>局部安装：<br><code>npm install imports-loader --save-dev</code></p>
<p>然后呢：<br><strong>entry.js</strong>文件设置：<br><code>var tab = require(&#39;imports?$=jquery!./jquery.tab&#39;);</code></p>
<p>webpack.confing.js配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">plugins: [</div><div class="line">new webpack.ProvidePlugin(&#123;</div><div class="line">$: &quot;jquery&quot;,</div><div class="line">jQuery: &quot;jquery&quot;,</div><div class="line">&quot;window.jQuery&quot;: &quot;jquery&quot;</div><div class="line">&#125;),</div><div class="line">new webpack.optimize.CommonsChunkPlugin(&apos;vendor&apos;, &apos;vendor.js&apos;)//这是第三方库打包生成的文件</div><div class="line"> ]</div></pre></td></tr></table></figure></p>
<h1 id="6-我在自己项目里实现的HMR"><a href="#6-我在自己项目里实现的HMR" class="headerlink" title="6. 我在自己项目里实现的HMR:"></a>6. 我在自己项目里实现的HMR:</h1>  <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// server.js</span></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by Duyb on 2016/11/25.</div><div class="line"> */</div><div class="line"><span class="comment">/**</span></div><div class="line"> * Module dependencies.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>);</div><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">'http'</span>);</div><div class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"><span class="keyword">var</span> favicon = <span class="built_in">require</span>(<span class="string">'serve-favicon'</span>);</div><div class="line"><span class="keyword">var</span> morgan = <span class="built_in">require</span>(<span class="string">'morgan'</span>);</div><div class="line"><span class="keyword">var</span> cookieParser = <span class="built_in">require</span>(<span class="string">'cookie-parser'</span>);</div><div class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">'body-parser'</span>);</div><div class="line"><span class="keyword">var</span> ejs = <span class="built_in">require</span>(<span class="string">'ejs'</span>);</div><div class="line"><span class="keyword">var</span> debug = <span class="built_in">require</span>(<span class="string">'debug'</span>)(<span class="string">'vue-webpack:server'</span>);</div><div class="line"><span class="keyword">var</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">var</span> config = <span class="built_in">require</span>(<span class="string">'../webpack.config.js'</span>);</div><div class="line"><span class="keyword">var</span> WebpackDevMiddleware = <span class="built_in">require</span>(<span class="string">'webpack-dev-middleware'</span>);</div><div class="line"><span class="keyword">var</span> WebpackHotMiddleware = <span class="built_in">require</span>(<span class="string">'webpack-hot-middleware'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> compiler = webpack(config); <span class="comment">// 调用webpack并把配置传递过去</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> routes = <span class="built_in">require</span>(<span class="string">'../src/routes/index'</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">var</span> app = express(); <span class="comment">// 实例化Express对象</span></div><div class="line"><span class="keyword">var</span> mode = app.get(<span class="string">'env'</span>);  <span class="comment">// development production</span></div><div class="line"></div><div class="line"><span class="comment">// 注册中间件</span></div><div class="line"><span class="keyword">if</span> (mode === <span class="string">'development'</span>) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'config.output.publicPath : '</span>, config.output.publicPath);</div><div class="line">  <span class="comment">// 使用 webpack-dev-middleware 中间件</span></div><div class="line">  <span class="keyword">var</span> devMiddleware = WebpackDevMiddleware(compiler, &#123;</div><div class="line">    <span class="attr">publicPath</span>: config.output.publicPath,</div><div class="line">    <span class="attr">stats</span>: &#123;</div><div class="line">      <span class="attr">color</span>: <span class="literal">true</span>,</div><div class="line">      <span class="attr">chunks</span>: <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line"></div><div class="line"><span class="comment">// 使用 webpack-hot-middleware 中间件</span></div><div class="line">  <span class="keyword">var</span> hotMiddleware = WebpackHotMiddleware(compiler, &#123;</div><div class="line">    <span class="attr">log</span>: <span class="built_in">console</span>.log</div><div class="line">  &#125;);</div><div class="line"></div><div class="line"><span class="comment">// webpack插件，监听html文件改变事件</span></div><div class="line">  compiler.plugin(<span class="string">'compilation'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">compilation</span>) </span>&#123;</div><div class="line">    compilation.plugin(<span class="string">'html-webpack-plugin-after-emit'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">data, cb</span>) </span>&#123;</div><div class="line">      <span class="comment">// 发布事件</span></div><div class="line">      hotMiddleware.publish(&#123; <span class="attr">action</span>: <span class="string">'reload'</span> &#125;)</div><div class="line">      cb()</div><div class="line">    &#125;)</div><div class="line">  &#125;)</div><div class="line"></div><div class="line">  app.use(devMiddleware);</div><div class="line">  app.use(hotMiddleware);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//******************************* ↓↓↓↓ Express ↓↓↓↓ *******************************</span></div><div class="line"></div><div class="line"><span class="comment">// view engine setup</span></div><div class="line">app.set(<span class="string">'views'</span>, path.join(__dirname, <span class="string">'../dist/views'</span>)); <span class="comment">// 视图</span></div><div class="line"><span class="comment">// app.set('view engine', 'jade');  // 模板引擎</span></div><div class="line"></div><div class="line"><span class="comment">// html</span></div><div class="line">app.engine(<span class="string">'.html'</span>, ejs.__express);</div><div class="line">app.set(<span class="string">'view engine'</span>, <span class="string">'html'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 禁用X-Powered-By</span></div><div class="line">app.disable(<span class="string">'x-powered-by'</span>);</div><div class="line"></div><div class="line"><span class="comment">// uncomment after placing your favicon in /public</span></div><div class="line">app.use(favicon(path.join(__dirname, <span class="string">'../src/assets/img/logo.png'</span>)));</div><div class="line">app.use(morgan(<span class="string">'dev'</span>));</div><div class="line">app.use(bodyParser.json());</div><div class="line">app.use(bodyParser.urlencoded(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</div><div class="line">app.use(cookieParser());</div><div class="line"><span class="keyword">if</span> (mode === <span class="string">'production'</span>) &#123;</div><div class="line">  app.use(express.static(path.join(__dirname, <span class="string">'../dist'</span>))); <span class="comment">// 利用 Express 托管静态文件 http://www.expressjs.com.cn/starter/static-files.html</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// routes</span></div><div class="line">app.use(<span class="string">'/'</span>, routes);</div><div class="line"></div><div class="line"><span class="comment">// catch 404 and forward to error handler</span></div><div class="line">app.use(<span class="function"><span class="keyword">function</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> err = <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Not Found'</span>);</div><div class="line">  err.status = <span class="number">404</span>;</div><div class="line">  next(err);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Get port from environment and store in Express.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">var</span> port = normalizePort(process.env.PORT || <span class="string">'3008'</span>);</div><div class="line">app.set(<span class="string">'port'</span>, port);</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Create HTTP server.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">var</span> server = http.createServer(app);</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Listen on provided port, on all network interfaces.</div><div class="line"> */</div><div class="line"></div><div class="line">server.listen(port, () =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log( <span class="string">'vue-webpack started in '</span> + app.get(<span class="string">'env'</span>) +<span class="string">' mode, on http://localhost:'</span> +</div><div class="line">      app.get(<span class="string">'port'</span>) + <span class="string">' .'</span> );</div><div class="line">&#125;);</div><div class="line">server.on(<span class="string">'error'</span>, onError);</div><div class="line">server.on(<span class="string">'listening'</span>, onListening);</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Normalize a port into a number, string, or false.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">normalizePort</span>(<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> port = <span class="built_in">parseInt</span>(val, <span class="number">10</span>);</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (<span class="built_in">isNaN</span>(port)) &#123;</div><div class="line">    <span class="comment">// named pipe</span></div><div class="line">    <span class="keyword">return</span> val;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (port &gt;= <span class="number">0</span>) &#123;</div><div class="line">    <span class="comment">// port number</span></div><div class="line">    <span class="keyword">return</span> port;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Event listener for HTTP server "error" event.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">onError</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (error.syscall !== <span class="string">'listen'</span>) &#123;</div><div class="line">    <span class="keyword">throw</span> error;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> bind = <span class="keyword">typeof</span> port === <span class="string">'string'</span></div><div class="line">      ? <span class="string">'Pipe '</span> + port</div><div class="line">      : <span class="string">'Port '</span> + port;</div><div class="line"></div><div class="line">  <span class="comment">// handle specific listen errors with friendly messages</span></div><div class="line">  <span class="keyword">switch</span> (error.code) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'EACCES'</span>:</div><div class="line">      <span class="built_in">console</span>.error(bind + <span class="string">' requires elevated privileges'</span>);</div><div class="line">      process.exit(<span class="number">1</span>);</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">case</span> <span class="string">'EADDRINUSE'</span>:</div><div class="line">      <span class="built_in">console</span>.error(bind + <span class="string">' is already in use'</span>);</div><div class="line">      process.exit(<span class="number">1</span>);</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      <span class="keyword">throw</span> error;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Event listener for HTTP server "listening" event.</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">onListening</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> addr = server.address();</div><div class="line">  <span class="keyword">var</span> bind = <span class="keyword">typeof</span> addr === <span class="string">'string'</span></div><div class="line">      ? <span class="string">'pipe '</span> + addr</div><div class="line">      : <span class="string">'port '</span> + addr.port;</div><div class="line">  debug(<span class="string">'Listening on '</span> + bind);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = app;</div></pre></td></tr></table></figure>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2016-11-07</span><i class="fa fa-tag"></i><a href="/tags/webpack/" title="webpack" class="tag">webpack </a></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,https://thxl2010.github.io/2016/11/07/Webpack study/,Duyb,Webpack study,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a role="navigation" href="/2017/07/29/Hexo/" title="Hexo配置" class="btn">上一篇</a></li><li class="next pagbuttons"><a role="navigation" href="/2016/06/23/Hybrid-ionic/" title="Hybrid：ionic" class="btn">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>